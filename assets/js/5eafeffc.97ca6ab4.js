"use strict";(self.webpackChunkmaptaskr_docs_copy=self.webpackChunkmaptaskr_docs_copy||[]).push([[7576],{86826:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>d});var s=n(74848),a=n(28453);const r={},i="Reporting a problem",o={id:"tutorials/maptaskr-for-power-pages-311-solution/reporting-a-problem",title:"Reporting a problem",description:"Problems are reported via a 2-step form. Clicking on a button will create a case with the Subject defaulted based on the button clicked.",source:"@site/docs/tutorials/maptaskr-for-power-pages-311-solution/reporting-a-problem.md",sourceDirName:"tutorials/maptaskr-for-power-pages-311-solution",slug:"/tutorials/maptaskr-for-power-pages-311-solution/reporting-a-problem",permalink:"/docs/tutorials/maptaskr-for-power-pages-311-solution/reporting-a-problem",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"maptaskrSidebar",previous:{title:"Displaying existing cases",permalink:"/docs/tutorials/maptaskr-for-power-pages-311-solution/displaying-existing-cases"},next:{title:"Introduction",permalink:"/docs/tutorials/maptaskr-for-dynamics-365-layer-authentication/introduction"}},c={},d=[];function p(e){const t={a:"a",code:"code",h1:"h1",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"reporting-a-problem",children:"Reporting a problem"}),"\n",(0,s.jsx)(t.p,{children:"Problems are reported via a 2-step form. Clicking on a button will create a case with the Subject defaulted based on the button clicked."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(79845).A+"",width:"936",height:"479"})}),"\n",(0,s.jsx)(t.p,{children:"The first form contains some Custom JavaScript to default the Subject drop-down value based on the parameter passed. (This is just sample code and not needed for the Maptaskr component)."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(51593).A+"",width:"936",height:"479"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"$(document).ready(function () {\n\t// Function to get query parameter by name\n\tfunction getQueryParam(name) {\n\t\tconst urlParams = new URLSearchParams(window.location.search);\n\t\treturn urlParams.get(name);\n\t}\n\t// Function to normalize a string (remove hyphens and spaces)\n\tfunction normalizeString(str) {\n\t\treturn str.replace(/[-_]/g, ' ').replace(/\\s/g, ' ').toLowerCase();\n\t}\n\t// Get the value of the 'subject' query parameter\n\tvar subjectParam = getQueryParam('subject');\n\t// If the 'subject' parameter exists\n\tif (subjectParam !== null) {\n\t\t// Normalize the subject parameter\n\t\tvar normalizedSubjectParam = normalizeString(subjectParam);\n\t\t// Loop through each option in the dropdown\n\t\t$('#subjectid option').each(function () {\n\t\t\t// Check if the normalized text of the option matches the normalized 'subject' parameter value\n\t\t\tif ($(this).text().toLowerCase() === normalizedSubjectParam.toLowerCase()) {\n\t\t\t\t// Set the selected option to the one that matches the 'subject' parameter\n\t\t\t\t$(this).prop('selected', true);\n\t\t\t\t// Exit the loop since we found the matching option\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n});\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The second step of the form is used to capture the location of the Case. It needs to include the Latitude and Longitude fields on the form to capture the pin location. Adding the Maptaskr PCF Control is described in detail here: ",(0,s.jsx)(t.a,{href:"/docs/power-pages/installation-guide/pcf-integration-and-configuration-within-forms#form-integration",children:"PCF Integration and Configuration Within Forms"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(73472).A+"",width:"936",height:"479"})}),"\n",(0,s.jsx)(t.p,{children:"The Enter Location form also contains Custom JavaScript to manage saving of the geospatial data."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(51803).A+"",width:"936",height:"479"})}),"\n",(0,s.jsx)(t.p,{children:"The code below is a Maptaskr API call to bind the pin\u2019s lat/long to the corresponding fields on the record."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"//once the document is loaded\n$(document).ready(function () {\n\t//registering the function that will let us know that Maptaskr is ready to work\n\twindow.maptaskrReady = function () {\n\t\tconsole.log('Maptaskr has Loaded');\n\t\tconsole.log(window.maptaskrPCF);\n\n\t\tvar lat = $('#maptaskr_maptaskrlatitude')[0];\n\t\tvar lon = $('#maptaskr_maptaskrlongitude')[0];\n\t\twindow['maptaskrPCF'].registerAddressFieldFunction(true, lat, lon, null, null, null, null, null, null);\n\t};\n});\n"})}),"\n",(0,s.jsx)(t.p,{children:"The end result is:"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"Incident Map"})," showing the location of existing cases in a defined area (the city limits)"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(3261).A+"",width:"1542",height:"909"})}),"\n",(0,s.jsx)(t.p,{children:"Clicking on a pin provides details of the Case"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(10665).A+"",width:"1613",height:"907"})}),"\n",(0,s.jsx)(t.p,{children:"The portal has a responsive design and can be used on mobile devices too, eliminating the need for 3rd-party apps."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(50979).A+"",width:"600",height:"1224"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"Muti-step form"})," for reporting new issues.\nStep 1 defaults the Subject based on the button clicked on from the Incident Map page."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(87940).A+"",width:"936",height:"479"})}),"\n",(0,s.jsx)(t.p,{children:"Step 2 provides address search."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(24799).A+"",width:"936",height:"479"})}),"\n",(0,s.jsx)(t.p,{children:"Satellite Map can be displayed, and the pin dragged to the precise location."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(11510).A+"",width:"936",height:"479"})}),"\n",(0,s.jsx)(t.p,{children:"A case is created for the submission and can be viewed against the Case record."}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(88817).A+"",width:"936",height:"479"})}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:n(94952).A+"",width:"936",height:"479"})})]})}function l(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},51593:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture10-417b095288e1e82dc37ceba9b46e2211.png"},73472:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture11-9d59d6e3c0e4207e40e9eb019a653551.png"},51803:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture12-4a624ba4207b691242629fa80f63fa07.png"},87940:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture15-1a9ecfce4ac7217f62ae7e584b50a3be.png"},24799:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture16-89c8860acfb52ca8d5981bafc710b1a4.png"},11510:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture17-27dc0f3b7b9a9e3c6c6bf951bfef6e2e.png"},88817:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture18-586dbfcc5aad335406d025265709e409.png"},94952:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture19-c0a862f03bbcabbb55bb4e5d21eeb6c2.png"},3261:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture21-1a1dbac192e0fe77196023ef503eee5a.png"},10665:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture22.1-a91e49c376fb2ad7182061a0c197b491.png"},50979:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture27-b2ed6988d758a38e2e1f5f41b7940e40.jpg"},79845:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/Picture9-fcbc78e1e1955e76f69c19c4884ce1d7.png"},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>o});var s=n(96540);const a={},r=s.createContext(a);function i(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);